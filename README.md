# Twitter 날짜 필터링 스크래퍼 + Excel 변환기

특정 날짜 이후의 트윗만 수집하고, 기준 날짜에 도달하면 자동으로 중단하는 고급 Twitter 스크래퍼입니다. **Excel 변환 기능**이 추가되어 수집된 데이터를 손쉽게 분석할 수 있습니다.

## 🚀 주요 기능

### ✨ 날짜 필터링
- **특정 날짜 이후 트윗만 수집**: 기준 날짜를 설정하여 그 이후의 트윗만 수집
- **자동 중단 기능**: 기준 날짜에 도달하면 자동으로 수집 중단 (트윗 수 제한 없음)
- **정확한 날짜 추출**: uniqueId와 datetime 필드에서 정확한 날짜 정보 추출
- **무제한 수집**: 날짜 조건만 만족하면 트윗 개수 제한 없이 수집

### 📊 Excel 변환 (NEW!)
- **자동 Excel 변환**: JSON 데이터를 Excel 파일로 자동 변환
- **한국시간 변환**: UTC 시간을 한국시간(KST)으로 자동 변환
- **계정명 추출**: uniqueId에서 계정명 자동 추출
- **상세 통계**: 날짜별, 계정별, 미디어별 통계 제공
- **컬럼 정리**: 계정명, 게시일자, 링크, 트윗내용 등 체계적 정리

### 🔧 기존 기능
- **가상 스크롤 대응**: Twitter의 무한 스크롤에 최적화된 실시간 수집
- **즉시 수집**: 각 스크롤 단계마다 즉시 데이터 수집하여 손실 방지
- **중복 제거**: 강력한 중복 검사로 데이터 품질 보장
- **상세 통계**: 수집 과정과 결과에 대한 자세한 분석 제공

## 📁 파일 구성

- `date-filtered-scraper.js` - **메인 스크래퍼** (날짜 필터링 기능)
- `json-to-excel-converter.js` - **Excel 변환기** (JSON → Excel 변환)
- `original-scraper.js` - 원본 스크래퍼 (참고용)
- `package.json` - 의존성 관리
- `README.md` - 사용 가이드

## 🛠️ 설치 및 설정

### 1. 의존성 설치
```bash
npm install puppeteer xlsx
```

### 2. Chrome 원격 디버깅 모드 실행
```bash
# Windows
chrome.exe --remote-debugging-port=9222 --user-data-dir="C:\\temp\\chrome_debug"

# macOS
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222 --user-data-dir="/tmp/chrome_debug"

# Linux
google-chrome --remote-debugging-port=9222 --user-data-dir="/tmp/chrome_debug"
```

### 3. Twitter 검색 준비
1. Chrome에서 X.com (구 Twitter) 접속
2. 원하는 해시태그나 키워드로 검색
3. 검색 결과 페이지를 "최신순"으로 정렬

## 📅 날짜 필터링 설정

### ⭐ 기준 날짜 변경 (중요!)
`date-filtered-scraper.js` 파일에서 다음 라인을 수정하세요:

```javascript
// ⭐ 날짜 필터 설정 (여기서 수정하세요!)
const cutoffDate = '2025-06-20'; // YYYY-MM-DD 형식
```

### 동작 원리
- **2025-06-20**을 기준으로 설정하면
- **2025-06-21, 2025-06-22** 등의 트윗은 수집
- **2025-06-20 또는 그 이전** 트윗이 발견되면 즉시 수집 중단

## 🚀 사용 방법

### 1단계: 트윗 수집
```bash
# 방법 1: npm 스크립트 사용
npm run scrape
npm start

# 방법 2: 직접 실행
node date-filtered-scraper.js
```

### 2단계: Excel 변환
```bash
# 방법 1: npm 스크립트 사용 (권장)
npm run convert
npm run excel

# 방법 2: 직접 실행
node json-to-excel-converter.js
```

## 📊 Excel 변환 결과

### 🏷️ 엑셀 컬럼 구성
| 컬럼명 | 설명 | 예시 |
|--------|------|------|
| **계정명** | 트위터 계정명 | cinema_1127 |
| **게시일자** | 한국시간으로 변환된 날짜 | 2025-06-22 22:17:50 |
| **링크** | 트윗 직접 링크 | https://x.com/cinema_1127/status/... |
| 트윗내용 | 트윗 내용 (100자 제한) | 25.06.22 서울에 출몰한 신월... |
| 해시태그 | 포함된 해시태그들 | #신월동행, #서울에출몰한신월동행 |
| 좋아요 | 좋아요 수 | 1 마음에 들어요 |
| 리트윗 | 리트윗 수 | 4 재게시 |
| 답글 | 답글 수 | 0 답글 |
| 이미지여부 | 이미지 포함 여부 | Y / N |
| 비디오여부 | 비디오 포함 여부 | Y / N |

### 📈 변환 통계 예시
```
📊 변환 통계:
==============
고유 계정 수: 34개

📅 날짜별 트윗 수:
   2025-06-22: 89개
   2025-06-21: 67개

📷 이미지 포함 트윗: 78개 (50.0%)
🎥 비디오 포함 트윗: 12개 (7.7%)
```

### 🎯 한국시간 변환 예시
```
UTC: 2025-06-22T13:17:50.000Z
↓ +9시간
KST: 2025-06-22 22:17:50
```

## 💡 활용 예시

### 1. 실시간 모니터링 → 즉시 분석
```bash
# 1. 실시간 트윗 수집
npm run scrape

# 2. Excel로 변환하여 분석
npm run excel
```

### 2. 정기적인 트렌드 분석
```bash
# 매일 자동화하여 트렌드 분석 가능
# 기준 날짜를 어제로 설정하고 실행
```

### 3. 이벤트 후 반응 분석
```bash
# 특정 이벤트 발생 후 모든 반응을 Excel로 정리
# cutoffDate를 이벤트 발생일로 설정
```

## 🔧 고급 설정

### Excel 컬럼 커스터마이징
`json-to-excel-converter.js`에서 원하는 컬럼 수정 가능:

```javascript
const row = {
    '계정명': extractUsername(tweet.uniqueId),
    '게시일자': convertToKoreanTime(tweet.datetime),
    '링크': tweet.link || '',
    // 여기에 추가 컬럼 정의 가능
    '사용자명': tweet.displayName,
    '팔로워수': tweet.followers, // 추가 데이터 있을 경우
};
```

### 파일명 패턴
- **수집 파일**: `twitter_date_filtered_2025-06-20_2025-06-22T15-01-35-783Z.json`
- **변환 파일**: `twitter_date_filtered_2025-06-20_엑셀변환_2025-06-22.xlsx`

## 🔍 문제 해결

### Excel 변환 관련
```bash
# xlsx 모듈이 없다는 오류
npm install xlsx

# JSON 파일을 찾을 수 없다는 오류
# → 먼저 스크래퍼를 실행하여 JSON 파일 생성 필요
npm run scrape
```

### 날짜 변환 오류
```bash
# 한국시간이 이상하게 나올 경우
# → 시스템 시간대 확인
date
```

### 데이터 품질 확인
```bash
# 변환된 Excel 파일에서 확인할 점:
# 1. 게시일자가 올바른 한국시간인지
# 2. 계정명이 제대로 추출되었는지  
# 3. 링크가 정상적으로 연결되는지
```

## 📈 성능 및 특징

### 🔄 완전 자동화
1. **수집 단계**: 날짜 조건에 따른 자동 수집
2. **변환 단계**: JSON → Excel 자동 변환
3. **분석 단계**: Excel에서 즉시 분석 가능

### ⚡ 한국 환경 최적화
- **한국시간 자동 변환** (UTC+9)
- **한글 컬럼명** 사용
- **한국어 통계** 제공

### 🎯 데이터 품질
- **중복 제거**: 스크래핑 단계에서 이미 처리
- **오류 처리**: 변환 실패시에도 계속 진행
- **진행상황 표시**: 대용량 데이터 처리시 진행률 표시

## 🚨 주의사항

1. **Excel 파일 크기**: 대용량 데이터(1000개+ 트윗)의 경우 Excel 파일이 클 수 있음
2. **메모리 사용량**: 변환 과정에서 임시적으로 메모리 사용량 증가
3. **파일 덮어쓰기**: 같은 날짜에 여러 번 변환시 파일명에 타임스탬프 포함됨
4. **Excel 호환성**: xlsx 형식으로 저장되어 Excel 2007 이상에서 호환

## 📞 지원

문제가 발생하거나 개선 제안이 있으시면 GitHub Issues를 통해 문의해주세요.

---

**개발자**: DevJihwan  
**라이센스**: MIT  
**버전**: 8.2 (Excel 변환 기능 추가)  
**기준 날짜**: 2025-06-20 (수정 가능)