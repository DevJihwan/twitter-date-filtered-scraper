# Twitter 날짜 필터링 스크래퍼 + 고급 Excel 변환기

특정 날짜 이후의 트윗만 수집하고, 기준 날짜에 도달하면 자동으로 중단하는 고급 Twitter 스크래퍼입니다. **실제 JSON 구조에 최적화된 Excel 변환 기능**으로 데이터 분석이 더욱 쉬워졌습니다.

## 🚀 주요 기능

### ✨ 날짜 필터링
- **특정 날짜 이후 트윗만 수집**: 기준 날짜를 설정하여 그 이후의 트윗만 수집
- **자동 중단 기능**: 기준 날짜에 도달하면 자동으로 수집 중단 (트윗 수 제한 없음)
- **정확한 날짜 추출**: uniqueId와 datetime 필드에서 정확한 날짜 정보 추출
- **무제한 수집**: 날짜 조건만 만족하면 트윗 개수 제한 없이 수집

### 📊 고급 Excel 변환 v2.0 (NEW!)
- **다중 시트 생성**: Twitter데이터, 수집통계, 인기해시태그 시트 자동 생성
- **한국시간 변환**: UTC 시간을 한국시간(KST)으로 자동 변환
- **상호작용 수치화**: "1 마음에 들어요" → `1` (숫자 형태로 변환)
- **상세 통계**: 계정별, 날짜별, 미디어별, 해시태그별 상세 분석
- **실제 JSON 구조 반영**: `username`, `displayName`, `interactions` 필드 정확히 활용

### 🔧 기존 기능
- **가상 스크롤 대응**: Twitter의 무한 스크롤에 최적화된 실시간 수집
- **즉시 수집**: 각 스크롤 단계마다 즉시 데이터 수집하여 손실 방지
- **중복 제거**: 강력한 중복 검사로 데이터 품질 보장

## 📁 파일 구성

- `date-filtered-scraper.js` - **메인 스크래퍼** (날짜 필터링 기능)
- `json-to-excel-converter.js` - **고급 Excel 변환기 v2.0** ⭐
- `original-scraper.js` - 원본 스크래퍼 (참고용)
- `package.json` - 의존성 관리
- `README.md` - 사용 가이드

## 🛠️ 설치 및 설정

### 1. 의존성 설치
```bash
npm install puppeteer xlsx
```

### 2. Chrome 원격 디버깅 모드 실행
```bash
# Windows
chrome.exe --remote-debugging-port=9222 --user-data-dir="C:\\temp\\chrome_debug"

# macOS
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222 --user-data-dir="/tmp/chrome_debug"

# Linux
google-chrome --remote-debugging-port=9222 --user-data-dir="/tmp/chrome_debug"
```

### 3. Twitter 검색 준비
1. Chrome에서 X.com (구 Twitter) 접속
2. 원하는 해시태그나 키워드로 검색
3. 검색 결과 페이지를 "최신순"으로 정렬

## 📅 날짜 필터링 설정

### ⭐ 기준 날짜 변경 (중요!)
`date-filtered-scraper.js` 파일에서 다음 라인을 수정하세요:

```javascript
// ⭐ 날짜 필터 설정 (여기서 수정하세요!)
const cutoffDate = '2025-06-20'; // YYYY-MM-DD 형식
```

### 동작 원리
- **2025-06-20**을 기준으로 설정하면
- **2025-06-21, 2025-06-22** 등의 트윗은 수집
- **2025-06-20 또는 그 이전** 트윗이 발견되면 즉시 수집 중단

## 🚀 사용 방법

### 🎯 한 번에 모든 작업 실행 (권장!)
```bash
npm run all    # 수집 + 변환을 한 번에!
```

### 단계별 실행
```bash
# 1단계: 트윗 수집
npm run scrape

# 2단계: Excel 변환
npm run excel
```

## 📊 Excel 변환 결과 v2.0

### 🏷️ 시트 구성 (3개 시트 자동 생성)

#### 1️⃣ Twitter데이터 시트
| 컬럼명 | 설명 | 예시 |
|--------|------|------|
| **계정명** | Twitter 계정명 | cinema_1127 |
| **표시명** | 사용자 표시명 | (빈 값일 수 있음) |
| **게시일자** | 한국시간 변환 | 2025-06-22 22:17:50 |
| **링크** | 트윗 직접 링크 | https://x.com/cinema_1127/status/... |
| 트윗내용 | 트윗 내용 (200자) | 25.06.22 서울에 출몰한 신월... |
| 해시태그 | 해시태그 목록 | #신월동행, #서울에출몰한신월동행 |
| **좋아요수** | 숫자 형태 | 1 |
| **리트윗수** | 숫자 형태 | 4 |
| **답글수** | 숫자 형태 | 0 |
| 이미지수 | 포함된 이미지 개수 | 1 |
| 이미지여부 | Y/N | Y |
| 비디오여부 | Y/N | N |
| 수집단계 | 수집된 단계 | initial_load |
| 수집시간 | 수집 시간 (한국시간) | 2025-06-22 23:01:10 |

#### 2️⃣ 수집통계 시트
| 항목 | 값 |
|------|-----|
| 총 트윗 수 | 57 |
| 고유 사용자 수 | 39 |
| 총 해시태그 수 | 169 |
| 이미지 포함 트윗 | 51 |
| 비디오 포함 트윗 | 5 |
| 수집 기간 (일) | 2 |
| 필터 기준 날짜 | 2025-06-20 |

#### 3️⃣ 인기해시태그 시트
| 순위 | 해시태그 | 사용횟수 | 비율(%) |
|------|----------|---------|---------|
| 1 | #서울에출몰한신월동행 | 51 | 30.2 |
| 2 | #신월동행 | 39 | 23.1 |
| 3 | #cosplay | 17 | 10.1 |

### 🎯 한국시간 변환 예시
```
UTC: 2025-06-22T13:17:50.000Z
↓ +9시간 자동 변환
KST: 2025-06-22 22:17:50
```

### 📈 변환 통계 예시 (실제 데이터 기준)
```
📊 변환 통계:
==============
고유 계정 수: 39개

👑 가장 활발한 계정 TOP 5:
   1. account1: 3개 트윗
   2. account2: 2개 트윗

📅 날짜별 트윗 수:
   2025-06-22: 35개
   2025-06-21: 22개

💝 상호작용 통계:
   총 좋아요: 156개
   총 리트윗: 89개
   평균 좋아요: 2.7개/트윗

📷 미디어 통계:
   이미지 포함 트윗: 51개 (89.5%)
   총 이미지 수: 73개
```

## 💡 활용 예시

### 1. 완전 자동화된 분석
```bash
# 매일 자동으로 수집하고 Excel로 분석
npm run all
```

### 2. 이벤트 후 반응 분석
```bash
# cutoffDate를 이벤트 발생일로 설정
# 모든 후속 반응을 Excel로 정리
```

### 3. 트렌드 모니터링
```bash
# 정기적으로 실행하여 트렌드 변화 추적
# Excel에서 날짜별 비교 분석
```

## 🔧 고급 설정

### 트윗 내용 길이 조정
```javascript
// json-to-excel-converter.js에서
'트윗내용': tweet.text ? tweet.text.replace(/\n/g, ' ').substring(0, 200) // 200자로 제한
```

### 추가 컬럼 정의
```javascript
const row = {
    // 기본 컬럼들...
    '팔로워수': tweet.followers, // 데이터가 있다면
    'RT비율': (row['리트윗수'] / row['좋아요수']).toFixed(2) // 계산 컬럼
};
```

### 파일명 패턴
- **수집 파일**: `twitter_date_filtered_2025-06-20_2025-06-22T15-06-35-311Z.json`
- **변환 파일**: `twitter_date_filtered_2025-06-20_엑셀변환_2025-06-22.xlsx`

## 📈 성능 및 특징

### 🔄 완전 자동화
1. **수집**: 날짜 조건에 따른 무제한 수집
2. **변환**: 다중 시트 Excel 자동 생성
3. **분석**: Excel에서 즉시 분석 가능

### ⚡ 한국 환경 최적화
- **한국시간 자동 변환** (UTC+9)
- **한글 컬럼명** 및 **한글 시트명**
- **한국어 통계** 제공

### 🎯 데이터 품질
- **정확한 수치 추출**: "1 마음에 들어요" → `1`
- **중복 제거**: 스크래핑 단계에서 처리
- **오류 복구**: 변환 실패시에도 계속 진행

## 🚨 주의사항

1. **Excel 호환성**: xlsx 형식 (Excel 2007 이상)
2. **대용량 처리**: 1000개+ 트윗도 안정적 처리
3. **메모리 효율성**: 단계별 처리로 메모리 최적화
4. **다중 시트**: 3개 시트 자동 생성으로 체계적 분석

## 🔍 문제 해결

### 변환 관련
```bash
# 모듈 설치
npm install xlsx

# 권한 문제 (Excel 파일 열려있을 때)
# → Excel 파일을 닫고 다시 실행
```

### 데이터 확인
```bash
# JSON 파일 확인
ls twitter_*.json

# 변환 로그 확인
npm run excel
```

## 📞 지원

문제가 발생하거나 개선 제안이 있으시면 GitHub Issues를 통해 문의해주세요.

---

**개발자**: DevJihwan  
**라이센스**: MIT  
**버전**: 8.3 (고급 Excel 변환 v2.0)  
**특징**: 다중 시트, 한국시간 변환, 상호작용 수치화  
**기준 날짜**: 2025-06-20 (수정 가능)